[package]
name = "dicee-engine"
version = "0.1.0"
edition = "2021"
description = "Probability engine for Dicee - Educational dice game platform"
license = "MIT"
repository = "https://github.com/verlyn13/dicee"
keywords = ["dicee", "probability", "wasm", "game-theory"]
categories = ["game-engines", "mathematics", "wasm"]

[lib]
crate-type = ["cdylib", "rlib"]

# =============================================================================
# DEPENDENCIES
# =============================================================================

[dependencies]
# Serialization
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"

# WASM support
wasm-bindgen = "0.2"
serde-wasm-bindgen = "0.6"

# Error handling (M1-M4 upgrade)
thiserror = "2.0"

# Exact arithmetic (feature-gated)
num-rational = { version = "0.4", optional = true }
num-traits = { version = "0.2", optional = true }

[dev-dependencies]
wasm-bindgen-test = "0.3"

# Property-based testing (M1-M4 upgrade)
proptest = "1.5"

# Benchmarking
criterion = { version = "0.5", features = ["html_reports"] }

# =============================================================================
# FEATURES
# =============================================================================

[features]
default = []

# Use exact rational arithmetic internally (slower but precise)
exact-rational = ["dep:num-rational", "dep:num-traits"]

# =============================================================================
# PROFILES
# =============================================================================

[profile.release]
opt-level = "s"      # Optimize for size (good for WASM)
lto = true           # Link-time optimization
codegen-units = 1    # Better optimization, slower compile
panic = "abort"      # Smaller binary

[profile.dev]
opt-level = 1        # Some optimization even in dev (probability tables are slow otherwise)

# Faster tests
[profile.test]
opt-level = 2

# =============================================================================
# BENCHMARKS (To be added in Phase 6)
# =============================================================================
# [[bench]]
# name = "transitions"
# harness = false
#
# [[bench]]
# name = "solver"
# harness = false
